.PHONY: help build run clean test install exemplo process-list

help: ## Mostra esta mensagem de ajuda
	@echo "ğŸ“‹ Comandos disponÃ­veis:"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "  \033[36m%-20s\033[0m %s\n", $$1, $$2}'

build: ## Compila o projeto
	@echo "ğŸ”¨ Compilando find-instagram..."
	@go build -o find-instagram main.go
	@echo "âœ… Build concluÃ­do!"

build-list: ## Compila o processador de listas
	@echo "ğŸ”¨ Compilando process-list..."
	@go build -o process-list process_list.go
	@echo "âœ… Build concluÃ­do!"

build-all: build build-list ## Compila todos os binÃ¡rios
	@echo "âœ… Todos os binÃ¡rios compilados!"

run: build ## Compila e executa com exemplo
	@echo "ğŸš€ Executando exemplo..."
	@./find-instagram "Magazine Luiza"

exemplo: build ## Executa exemplo com Magazine Luiza
	@./find-instagram "Magazine Luiza"

exemplo-dimazzo: build ## Executa exemplo com Dimazzo Arapongas
	@./find-instagram "dimazzo arapongas"

process-list: build-list ## Processa lista de empresas (use LISTA=arquivo.txt)
	@if [ -z "$(LISTA)" ]; then \
		echo "âŒ Uso: make process-list LISTA=arquivo.txt"; \
		exit 1; \
	fi
	@./process-list $(LISTA)

clean: ## Remove binÃ¡rios e arquivos temporÃ¡rios
	@echo "ğŸ§¹ Limpando..."
	@rm -f find-instagram process-list
	@rm -f *.csv
	@echo "âœ… Limpeza concluÃ­da!"

test: ## Executa os testes
	@echo "ğŸ§ª Executando testes..."
	@go test -v ./...

install: ## Instala as dependÃªncias
	@echo "ğŸ“¦ Instalando dependÃªncias..."
	@go mod download
	@go mod tidy
	@echo "âœ… DependÃªncias instaladas!"

fmt: ## Formata o cÃ³digo
	@echo "ğŸ¨ Formatando cÃ³digo..."
	@go fmt ./...
	@echo "âœ… CÃ³digo formatado!"

vet: ## Analisa o cÃ³digo
	@echo "ğŸ” Analisando cÃ³digo..."
	@go vet ./...
	@echo "âœ… AnÃ¡lise concluÃ­da!"
